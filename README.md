# gRPCCalculator

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

–°–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ü–∏—Ñ—Ä—ã –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ `+`, `-`, `*`, `/`). –í–∫–ª—é—á–∞–µ—Ç:

- gRPC –∏ REST API
- Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –°–∏—Å—Ç–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ –æ–±—Ä–∞—Ç–Ω—É—é –ø–æ–ª—å—Å–∫—É—é –Ω–æ—Ç–∞—Ü–∏—é (RPN), —Ä–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ –∑–∞–¥–∞—á–∏ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏—Ö –º–µ–∂–¥—É –≤–æ—Ä–∫–µ—Ä–∞–º–∏.

–ö–æ–Ω—Ç–∞–∫—Ç: [@OnYyon](https://t.me/OnYyon)

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```mermaid
graph TD
    A[Web Interface] -->|HTTP| B[Orchestrator]
    C[API Client] -->|gRPC| B
    B -->|Tasks| D[Worker 1]
    B -->|Tasks| E[Worker 2]
    B -->|Tasks| F[Worker N]
    D -->|Results| B
    E -->|Results| B
    F -->|Results| B
    B -->|Store| G[Database]
    A -->|Get Results| G
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

- **Web Interface** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (`–ø–æ—Ä—Ç 8081`)
- **Orchestrator** ‚Äî —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã (`–ø–æ—Ä—Ç 8080`)
  - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è
  - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ RPN
  - –†–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ –∑–∞–¥–∞—á–∏
  - –£–ø—Ä–∞–≤–ª—è–µ—Ç –≤–æ—Ä–∫–µ—Ä–∞–º–∏
- **Workers** ‚Äî –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —É–∑–ª—ã
- **Database** ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

- **Docker** –∏–ª–∏ **Go 1.24+**

### üîß –ó–∞–ø—É—Å–∫

#### 1. –ß–µ—Ä–µ–∑ Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
git clone https://github.com/OnYyon/gRPCCalculator.git
cd gRPCCalculator
docker-compose up --build
```
–ü—Ä–∏ **–ø–æ–≤—Ç–æ—Ä–Ω–æ–º** –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ—Å—Ç–æ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å<br>
–¢–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ –æ—Ç—Å–∞–Ω—É—Ç—å—Å—è –¥–∞–Ω–Ω—ã–µ –≤ –±–¥
```bash
docker-compose up
```
#### 2. –í—Ä—É—á–Ω—É—é (—Ç—Ä–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞)

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1 - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
go run cmd/orchestrator/main.go

# –¢–µ—Ä–º–∏–Ω–∞–ª 2 - –í–æ—Ä–∫–µ—Ä
go run cmd/worker/main.go

# –¢–µ—Ä–º–∏–Ω–∞–ª 3 - –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
go run web/main.go
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ Web Interface –Ω–∞ [`http://localhost:8081`](http://localhost:8081)

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
1. –ó–∞—Ä–µ–≥–µ—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å<br>
    1.1 –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞ `Registration failed`, —Ç–æ —Ç–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å–æ–∑–∞–Ω
2. –ó–∞–ª–æ–≥–∏–Ω—Ç–µ—Å—å
3. –ò –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤–æ –≤–∫–ª–∞–¥–∫–µ `calculate`
4. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤–æ –≤–∫–ª–∞–¥–∫–µ `expressions`

---

## ‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è:

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ web –∏–ª–∏ API)
2. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä:
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
   - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ RPN
   - –†–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏
3. –í–æ—Ä–∫–µ—Ä—ã –≤—ã—á–∏—Å–ª—è—é—Ç —á–∞—Å—Ç–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è

### üß© –ü—Ä–∏–º–µ—Ä: `1 + (2 + 3) + (4 + 5) + (6 + 7) + (4 * 3 / 8)`

- **RPN:** `1 2 3 + + 4 5 + + 6 7 + + 4 3 * 8 / +`
- **–ó–∞–¥–∞—á–∏ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ):**
  - `2 3 + ‚Üí 5`
  - `4 5 + ‚Üí 9`
  - `6 7 + ‚Üí 13`
  - `4 3 * ‚Üí 12`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ):**
  - `1 5 + ‚Üí 6`
  - `6 9 + ‚Üí 15`
  - `15 13 + ‚Üí 28`
  - `12 8 / ‚Üí 1.5`
  - `28 1.5 + ‚Üí 29.5`

---

## üîå API –ü—Ä–∏–º–µ—Ä—ã

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

```bash
curl -X POST http://localhost:8080/api/register   -H "Content-Type: application/json"   -d '{"login": "user", "password": "pass"}'
```

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

```bash
LOGIN_RESPONSE=$(curl -s -X POST http://localhost:8080/api/login   -H "Content-Type: application/json"   -d '{"login": "user", "password": "pass"}')
TOKEN=$(echo $LOGIN_RESPONSE | jq -r '.token')
```
### –ù–µ–≤–µ—Ä–∞–Ω—è –∞—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```bash
curl -X POST http://localhost:8080/api/register \
  -H "Content-Type: application/json" \
  -d '{"login": "", "password": "123"}'
```
```bash
curl -X POST http://localhost:8080/api/login \
  -H "Content-Type: application/json" \
  -d '{"login": "user", "password": "wrongpass"}'
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏—è

```bash
curl -X POST http://localhost:8080/api/expression   -H "Authorization: Bearer $TOKEN"   -H "Content-Type: application/json"   -d '{"expression": "2 + 2 * 2"}'
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# –í—Å–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
curl -X GET http://localhost:8080/api/expressions   -H "Authorization: Bearer $TOKEN"

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
curl -X GET "http://localhost:8080/api/expression/1"   -H "Authorization: Bearer $TOKEN"
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Ç–µ—Å—Ç–æ–≤ **—É–¥–∞–ª–∏—Ç–µ —Ñ–∞–π–ª –ë–î**:
–≠—Ç–æ –Ω—É–∂–Ω–æ —Ç–∞–∫ –∫–∞–∫ —Ç–µ—Å—Ç—ã —Å–æ–∑–¥–∞—é –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–æ–Ω–æ–º –∑–∞–ø–∫—Å–∫–µ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –µ—Å—Ç—å

```bash
go test ./tests -v
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è         | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ                         |
|--------------------|------------------------|----------------------------------|
| `COMPUTING_POWER`  | 13                     | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤              |
| `ORCHESTRATOR_PORT`| 8080                   | –ü–æ—Ä—Ç –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞                |
| `WEB_PORT`         | 8081                   | –ü–æ—Ä—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞              |

---
